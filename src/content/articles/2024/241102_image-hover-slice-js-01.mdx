---
title: ã€JSãƒ»GSAPã€‘ãƒ›ãƒãƒ¼ã§ç”»åƒã‚’åˆ†å‰²ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
slug: image-hover-slice-js-01
pubDate: '2024-11-02'
image: ../../../assets/images/image-hover-slice-js-01.jpg
ogp: 'images/ogp/image-hover-slice-js-01.jpg'
category: Coding
tags:
  - JavaScript
  - GSAP
description: JavaScriptã§GSAPã¨clip-pathã‚’ä½¿ã£ã¦ã€ç”»åƒãƒ›ãƒãƒ¼ã§ç”»åƒã‚’åˆ†å‰²ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è§£èª¬ã—ã¾ã™ã€‚JavaScriptã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§åˆ†å‰²æ•°ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹å‘ã‚‚ç°¡å˜ã«æ±ºã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
relatedPosts:
  - sticky-js-01
  - image-hover-parallax-js-01
  - mouse-blur-clip-path
---
import CodePenEmbed from '../../../components/markdown/CodePenEmbed.astro';

## ã¯ã˜ã‚ã«

ä»Šå›ã¯ã€ãƒ›ãƒãƒ¼ã—ãŸæ™‚ã«ç”»åƒãŒåˆ†å‰²ã—ã¦å‡ºç¾ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ğŸ•
ç”»åƒã®åˆ†å‰²æ•°ã‚„ç¸¦æ¨ªã®å‡ºç¾æ–¹å‘ã‚‚HTMLå†…ã§dataå±æ€§ã‚’ä½¿ã£ã¦æ±ºã‚ã‚‰ã‚Œã¾ã™ï¼

ğŸ‘‡ã¯å®Œæˆå½¢ã®CodePenãƒ‡ãƒ¢ã§ã™ï¼
<CodePenEmbed penId="BaXVBvO" title="Slice Image Hover Effect with Clip-Path" />

çµè«–ã¨ã—ã¦ã¯ã€ç”»åƒã®åˆ†å‰²ã¯clip-pathã§ã‚„ã‚Šãƒ›ãƒãƒ¼å‰ã«translateã§ç§»å‹•ã•ã›ã¦ãŸã‚‚ã®ã‚’ãƒ›ãƒãƒ¼ã—ãŸã‚‰æˆ»ã™ã“ã¨ã§ã“ã®ã‚ˆã†ãªè¡¨ç¾ãŒã§ãã¾ã™ï¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯JavaScriptã§GSAPã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ğŸ€
ãã‚Œã§ã¯è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

## HTMLã¨CSS

ã¾ãšã¯åŸºæœ¬çš„ãªHTMLã¨CSSã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### HTML

```html title="index.html"
<div class="card"
  data-img-hover="slice"
  data-slice-number="5"
  data-slice-direction="vertical"
  >
  <div class="card-img-wrap">
    <div class="card-img">
      <img src="https://picsum.photos/300/300?random=0" alt="">
    </div>
  </div>
  <div class="card-title">sample title</div>
</div>
```

ã“ã“ã§åˆ†å‰²æ•°ã‚’`data-slice-number`ã§ã€å‡ºç¾æ–¹å‘ã‚’`data-slice-direction`ã§dataå±æ€§ã‚’åˆ©ç”¨ã—ã¦æ±ºã‚ã‚‰ã‚Œã¾ã™ã€‚ç¸¦ã‹ã‚‰ã®å‡ºç¾ã¯verticalã§ã€æ¨ªã‹ã‚‰ã¯horizonã«ãªã‚Šã¾ã™ï¼
ã¾ãŸã€JavaScriptå´ã§åˆ†å‰²æ•°ã«å¿œã˜ãŸç”»åƒã®æ•°ã‚’`.card-img-wrap`ã«å…¥ã‚Œã¦ã„ãã¾ã™ã€‚

ãã‚Œã§ã¯CSSã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### CSS

ä»Šå›ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«é–¢ä¿‚ãŒã‚ã‚Šãã†ãªç®‡æ‰€ã¯ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™

```css title="style.scss"
.card {
  position: relative;
  min-height: 200px;
  aspect-ratio: 1 / 1;
  overflow: hidden;
  border: 1px solid #ffffff4c;
  display: grid;
  place-items: center;
}

.card-img-wrap {
  position: absolute;
  inset: 0;
}

.card-img {
  --slice-num: 5;
  width: calc(100% + (var(--slice-num) - 1) * 1px);
  height: calc(100% + (var(--slice-num) - 1) * 1px);
  position: absolute;
  inset: 0;
  opacity: 0;
  z-index: -1;
  filter: brightness(5);
}

.card-title {
  color: #fff;
  text-align: center;
  font-size: 40px;
  font-weight: 700;
}
```

ç”»åƒè‡ªä½“ã¯`position: absolute`ã¨`inset: 0`ã§ã‚«ãƒ¼ãƒ‰å†…ã«ä½ç½®ã•ã›ã€JavaScriptã§ä¸Šä¸‹ã‹å·¦å³ã«ç§»å‹•ã•ã›ã¾ã™ã€‚
`.card-img`ã®widthã¨heightã«é–¢ã—ã¦ã¯ç”»åƒåˆ†å‰²ã§clip-pathã‚’ä½¿ã†éƒ½åˆä¸Šã€éš™é–“ãŒã§ãã¦ã—ã¾ã†ã®ã§ãã®å¯¾ç­–ã§ã™ï¼ã“ã¡ã‚‰ã¯JavaScriptã®æ–¹ã§è©³ã—ãè¦‹ã¦ã„ãã¾ã™ã€‚


## JavaScript

ğŸ‘‡ã¯ä»Šå›ã®JavaScriptã®å…¨ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚

```js title="script.js"
class SliceImageHover {
  constructor() {
    this.els = document.querySelectorAll('[data-img-hover="slice"]');
    if(!this.els.length) return
    this.init();
  }
  init() {
    this.els.forEach(el => {

      const option = {
        number: el.dataset.sliceNumber || 5,
        direction: el.dataset.sliceDirection || 'vertical',
      }

      this.imageWrap = el.querySelector('.card-img-wrap');
      this.image = this.imageWrap.querySelector('.card-img');

      this.setUpImage(option.number);
      this.setClipPath(option);
      this.animation(el, option.direction);
    })
  }
  setUpImage(number) {
    for (let i = 0; i < number-1; i++) {
      const clone = this.image.cloneNode(true);
      this.imageWrap.appendChild(clone);
    }
    this.images = this.imageWrap.querySelectorAll('.card-img');
  }
  setClipPath(option) {
    const number = option.number;
    const direction = option.direction;

    this.images.forEach((img, i) => {
      let a1 = i * 100 / number;
      let b1 = a1 + 100 / number;

      if (direction === 'vertical') {
        img.style.clipPath = `polygon(${a1}% 0%, ${b1}% 0%, ${b1}% 100%, ${a1}% 100%)`;
        img.style.translate = i % 2 === 1 ? '0 -80%' : '0 80%';
        img.style.left = `-${i}px`;
      } else {
        img.style.clipPath = `polygon(0% ${a1}%, 100% ${a1}%, 100% ${b1}%, 0% ${b1}%)`;
        img.style.translate = i % 2 === 1 ? '-80% 0' : '80% 0';
        img.style.top = `-${i}px`;
      }

      img.style.setProperty('--slice-num', number);
    });
  }
  animation(el, direction) {
    const tl = gsap.timeline({ paused: true });
    const isVertical = direction === 'vertical';

    tl.to(this.images, {
      [isVertical ? 'y' : 'x']: 0,
      opacity: 1,
      filter: 'brightness(1)',
      duration: 0.6,
      ease: 'power2.inOut',
    });

    el.addEventListener('mouseenter', () => tl.play());
    el.addEventListener('mouseleave', () => tl.reverse());
  }
}

new SliceImageHover();
```

å†’é ­ã«è¿°ã¹ãŸã‚ˆã†ã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯GSAPã‚’ä½¿ç”¨ã—ã¾ã™ï¼
ãã‚Œã§ã¯è©³ã—ãè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### init()

```js
init() {
  this.els.forEach(el => {

    const option = {
      number: el.dataset.sliceNumber || 5,
      direction: el.dataset.sliceDirection || 'vertical',
    }

    this.imageWrap = el.querySelector('.card-img-wrap');
    this.image = this.imageWrap.querySelector('.card-img');

    this.setUpImage(option.number);
    this.setClipPath(option);
    this.animation(el, option.direction);
  })
}
```

ã“ã“ã§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦dataå±æ€§ã§æ±ºã‚ãŸåˆ†å‰²æ•°ã¨å‡ºç¾æ–¹å‘ã‚’å¤‰æ•°ã«å…¥ã‚Œã¾ã™ã€‚
ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”»åƒã‚’è¤‡è£½ã™ã‚‹`setUpImage()`ã€åˆ†å‰²ã™ã‚‹`setClipPath()`ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã‚‹`animation()`ãƒ¡ã‚½ãƒƒãƒ‰ã«å¼•æ•°ã§æ¸¡ã—ã¦ã‚ã’ã¾ã™ã€‚

### setUpImage()

ã“ã“ã§ã¯åˆ†å‰²æ•°ã«å¿œã˜ã¦ç”»åƒã‚’è¤‡è£½ã—ã¦ã„ãã¾ã™ã€‚

```js
setUpImage(number) {
  for (let i = 0; i < number-1; i++) {
    const clone = this.image.cloneNode(true);
    this.imageWrap.appendChild(clone);
  }
  this.images = this.imageWrap.querySelectorAll('.card-img');
}
```

ã™ã§ã«ç”»åƒã¯1ã¤ã‚ã‚Šã¾ã™ã®ã§ã€1å¼•ã„ã¦forãƒ«ãƒ¼ãƒ—ã‚’å›ã—ã¦`cloneNode()`ã§è¤‡è£½ã—ã¦`appendChild()`ã§`..card-img-wrap`ã®ä¸­ã«å…¥ã‚Œã¦ã„ãã¾ã™ã€‚this.imagesã¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ã„ã¾ã™ã€‚

### setClipPath()

setClipPath()ã§ã¯ç”»åƒã‚’clip-pathã§åˆ†å‰²ã—ã¾ã™ã€‚

```js
setClipPath(option) {
  const number = option.number;
  const direction = option.direction;

  this.images.forEach((img, i) => {
    let a1 = i * 100 / number;
    let b1 = a1 + 100 / number;

    if (direction === 'vertical') {
      img.style.clipPath = `polygon(${a1}% 0%, ${b1}% 0%, ${b1}% 100%, ${a1}% 100%)`;
      img.style.translate = i % 2 === 1 ? '0 -80%' : '0 80%';
      img.style.left = `-${i}px`;
    } else {
      img.style.clipPath = `polygon(0% ${a1}%, 100% ${a1}%, 100% ${b1}%, 0% ${b1}%)`;
      img.style.translate = i % 2 === 1 ? '-80% 0' : '80% 0';
      img.style.top = `-${i}px`;
    }

    img.style.setProperty('--slice-num', number);
  });
}
```

img.style.clipPathã®ã¨ã“ã‚ã¯[Clippy](https://bennettfeely.com/clippy/)ãªã©ã®ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã§å®Ÿéš›ã«è‡ªåˆ†ã§è§¦ã£ã¦ã¿ã‚‹ã¨ç†è§£ã§ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚å‡ºç¾æ–¹å‘ã«ã‚ˆã£ã¦å¤‰ãˆã¦ã„ã‚‹ã£ã¦æ„Ÿã˜ã§ã™ã­ï¼

ãƒ›ãƒãƒ¼å‰ã«translateã§ä½ç½®ã‚’ç§»å‹•ã•ã›ã¦ãŠãã®ã§ã™ãŒã€ç¸¦æ–¹å‘ã®ã¨ãã¯å¶æ•°ã¯ä¸‹ã‹ã‚‰ã€å¥‡æ•°ã¯ä¸Šã‹ã‚‰å‡ºç¾ã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

ã¾ãŸã€å…ˆè¿°ã—ãŸã‚ˆã†ã«clip-pathã§åˆ†å‰²ã—ã¦ã„ã‚‹ã®ã§éš™é–“ãŒå‡ºã¦ãã¦ã—ã¾ã„ã¾ã™ã€‚
ãªã®ã§leftãªã©ã§ãšã‚‰ã—ã¦ã‚ã’ã¾ã™ã€‚ãã®ä¸Šã§CSSã‚‚èª¿æ•´ã—ã¾ã™ã€‚
â†“ã¯CSSã®å¯¾ç­–ç®‡æ‰€ã®å†æ²ã§ã™ï¼

```css
.card-img {
  --slice-num: 5;
  width: calc(100% + (var(--slice-num) - 1) * 1px);
  height: calc(100% + (var(--slice-num) - 1) * 1px);
}
```

éš™é–“ãŒå‡ºãªã„ã‚ˆã†ã«CSSãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®`--slice-num`ã§åˆ†å‰²æ•°ã®å€‹æ•°ã‚’ã‚»ãƒƒãƒˆã—ã¦CSSã§ãã®å€‹æ•°åˆ†ã‚’widthã¨heightã§åºƒã’ã¦ã‚ã’ã¦ã„ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šclip-pathã§åˆ†å‰²ã—ã¦ã‚‚éš™é–“ãŒå‡ºãªããªã‚Šã¾ã™ï¼
ãœã²å¯¾ç­–ã—ã¦ãªã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚‚è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼

### animation()

æœ€å¾Œã«ãƒ›ãƒãƒ¼æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ãªã‚Šã¾ã™ã€‚

```js
animation(el, direction) {
  const tl = gsap.timeline({ paused: true });
  const isVertical = direction === 'vertical';

  tl.to(this.images, {
    [isVertical ? 'y' : 'x']: 0,
    opacity: 1,
    filter: 'brightness(1)',
    duration: 0.6,
    ease: 'power2.inOut',
  });

  el.addEventListener('mouseenter', () => tl.play());
  el.addEventListener('mouseleave', () => tl.reverse());
}
```

ãƒ›ãƒãƒ¼å‰ã«ãšã‚‰ã—ã¦ã„ãŸä½ç½®ã‚’å…ƒã«æˆ»ã™ã ã‘ã§ã™ã­ï¼

ãƒã‚¦ã‚¹ãŒå…¥ã£ãŸã‹å‡ºãŸã®ã‹ã®åˆ¶å¾¡ã¯GSAPã®`timeline()`ã‚’ä½¿ã„ã¾ã™ã€‚
ãƒã‚¦ã‚¹ãŒå…¥ã‚Œã°`play()`ã‚’ã€å‡ºã‚Œã°`reverse()`ã§æˆ»ã™ã“ã¨ã§å®Ÿç¾ã§ãã¦ã¾ã™ï¼

## ã¾ã¨ã‚

GSAPã¨clip-pathã‚’ä½¿ã£ã¦ãƒ›ãƒãƒ¼ã—ãŸæ™‚ã«ç”»åƒãŒåˆ†å‰²ã—ã¦å‡ºç¾ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã—ãŸã€‚
clip-pathã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ç®‡æ‰€ãŒåˆ†ã‹ã‚Šã¥ã‚‰ã„ã‹ã¨ã¯æ€ã„ã¾ã™ãŒã€ãœã²ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ãªã©ã‚’ä½¿ã£ã¦ã©ã†ãªã£ã¦ã„ã‚‹ã®ã‹ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ï¼

ã“ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚