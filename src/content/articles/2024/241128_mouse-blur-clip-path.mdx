---
title: ãƒã‚¦ã‚¹ç§»å‹•ã§èƒŒæ™¯ã‚’åˆ‡ã‚ŠæŠœãï¼clip-pathã¨blurã‚’ä½¿ã£ãŸå‹•çš„ãƒ‡ã‚¶ã‚¤ãƒ³ã®ä½œã‚Šæ–¹ã€JSãƒ»GSAPã€‘
slug: mouse-blur-clip-path
pubDate: '2024-11-28'
image: ../../../assets/images/mouse-blur-clip-path.jpg
ogp: 'images/ogp/mouse-blur-clip-path.jpg'
category: Coding
tags:
  - JavaScript
  - GSAP
description: clip-pathã‚’ä½¿ã£ã¦ãƒã‚¦ã‚¹ç§»å‹•ã§å…¨é¢ã«blurãŒã‹ã‹ã£ãŸèƒŒæ™¯ã‚’åˆ‡ã‚ŠæŠœãå®Ÿè£…æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯GSAPã‚’ä½¿ã£ã¦ã„ã¾ã™
relatedPosts:
  - sticky-js-01
  - image-hover-parallax-js-01
  - image-hover-slice-js-01
---
import CodePenEmbed from '../../../components/markdown/CodePenEmbed.astro';
import PostAdUnit from '../../../components/markdown/PostAdUnit.astro';

## ã¯ã˜ã‚ã«

â†“ã®ã‚µã‚¤ãƒˆã®404ãƒšãƒ¼ã‚¸ãŒé¢ç™½ãã†ã ã£ãŸã®ã§çœŸä¼¼ã—ã¦å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚
[Dondre Green](https://www.dondregreen.com)

ä»Šå›ã‚„ã‚‹ã“ã¨ã¯ã€ç”»é¢å…¨é¢ã«blurãŒã‹ã‹ã£ãŸèƒŒæ™¯ã‚’ãƒã‚¦ã‚¹ç§»å‹•ã§ã‹ã¤clip-pathã‚’ä½¿ã£ã¦ã€èƒŒæ™¯ã‚’åˆ‡ã‚ŠæŠœãã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªå®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚
ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ¶å¾¡ã«ã¯GSAPã‚’ä½¿ã„ã¾ã™ğŸ€

ğŸ‘‡ã¯å®Œæˆå½¢ã®CodePenãƒ‡ãƒ¢ã§ã™ï¼
<CodePenEmbed penId="ZYzEyqZ" title="MouseMove Clip Path Blur" />

ãã‚Œã§ã¯è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

## HTMLã¨CSS

ã¾ãšã¯åŸºæœ¬çš„ãªHTMLã¨CSSã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### HTML

JavaScriptã§æ“ä½œã™ã‚‹ã®ã«å¿…è¦ãªã‚‚ã®ã ã‘æŠœç²‹ã—ã¾ã™ã€‚

```html title="index.html"
<div class="container">
  <!-- èƒŒæ™¯ã®blur -->
  <div class="overlay"></div>
  <!-- ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ -->
  <div class="cursor">
    <div class="cursor-deco-wrap">
      <div class="cursor-deco"></div>
      <div class="cursor-deco"></div>
      <div class="cursor-deco"></div>
      <div class="cursor-deco"></div>
    </div>
  </div>
</div>
```

blurãŒã‹ã‹ã£ãŸèƒŒæ™¯ã¯`.overlay`ã§ã€ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã‚’`.cursor`ã‚¯ãƒ©ã‚¹ã«ã—ã¦ã¾ã™ï¼ğŸ­

ãã‚Œã§ã¯CSSã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### CSS

ä»Šå›ã®å®Ÿè£…ã«é–¢ä¿‚ãŒã‚ã‚Šãã†ãªç®‡æ‰€ã¯ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™

```css title="style.scss"
.container {
  width: 100vw;
  height: 100vh;
  background: #010101;
  color: #fefae0;
  display: grid;
  place-items: center;
  position: relative;
  overflow: hidden;
}

.overlay {
  width: 100%;
  height: 100%;
  position: fixed;
  inset: 0;
  backdrop-filter: blur(20px);
  z-index: 2;
}

.cursor {
  width: 20vw;
  height: 20vw;
  position: absolute;
  left: 50%;
  top: 50%;
  translate: -50% -50%;
  z-index: 3;
}

.cursor-deco {
  width: 24px;
  height: 24px;
  position: absolute;
  border-color: #fefae0;
  border-width: 2px;
  &:nth-child(1) {
    border-left: 1px solid;
    border-top: 1px solid;
    top: 0;
    left: 0;
  }
  &:nth-child(2) {
    border-right: 1px solid;
    border-top: 1px solid;
    top: 0;
    right: 0;
  }
  &:nth-child(3) {
    border-left: 1px solid;
    border-bottom: 1px solid;
    bottom: 0;
    left: 0;
  }
  &:nth-child(4) {
    border-right: 1px solid;
    border-bottom: 1px solid;
    bottom: 0;
    right: 0;
  }
}
```

èƒŒæ™¯ã®blurã¯`backdrop-filter: blur(20px);`ã§è¡¨ç¾ã§ãã¾ã™ï¼
ã¾ãŸã€ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã®é£¾ã‚Š(.cursor-deco)ã¯å‰é¢ã«å‡ºã¦ã»ã—ã„ã®ã§z-indexã‚’.overlayã‚ˆã‚Šå¤§ããã—ã¦ã¾ã™ã€‚

æœ€å¾Œã«JavaScriptã«ãªã‚Šã¾ã™ï¼

<PostAdUnit />

## JavaScript

ğŸ‘‡ã¯ä»Šå›ã®JavaScriptã®å…¨ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚

```js title="script.js"
class MouseClipBlur {
  constructor() {
    this.mouse = document.querySelector('.cursor');
    if(!this.mouse) return
    this.init();
  }
  init() {
    this.overlay = document.querySelector('.overlay');

    const setClipPathValue = this.getMaskValue(window.innerWidth/2, window.innerHeight/2)
    gsap.set(this.overlay, { clipPath: setClipPathValue });

    window.addEventListener('mousemove', (e) => this.onMouseMove(e));
  }
  onMouseMove(e) {
    gsap.to(this.mouse, {
      x: e.clientX,
      y: e.clientY,
      top: 0,
      left: 0,
      duration: 0.5,
      onStart: () => {
        this.updateMask(e.clientX, e.clientY);
      }
    })
  }
  getMaskValue(x, y) {
    const { width, height } = this.mouse.getBoundingClientRect();
    const offset = 40;

    const boxWidth = width - offset; // åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®å¹…
    const boxHeight = height - offset; // åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®é«˜ã•

    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    const left = Math.max(x - boxWidth / 2, 0);
    const top = Math.max(y - boxHeight / 2, 0);
    const right = Math.min(x + boxWidth / 2, viewportWidth);
    const bottom = Math.min(y + boxHeight / 2, viewportHeight);

    const clipPathValue = `polygon(
      0% 0%,
      0% 100%,
      ${left}px 100%,
      ${left}px ${top}px,
      ${right}px ${top}px,
      ${right}px ${bottom}px,
      ${left}px ${bottom}px,
      ${left}px 100%,
      100% 100%,
      100% 0%
    )`;
    return clipPathValue;
  }
  updateMask(x, y) {
    gsap.to(this.overlay, {
      clipPath: this.getMaskValue(x, y),
      duration: 0.2,
    });
  }
}

new MouseClipBlur();
```

ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã‚„clip-pathã®å€¤ã®è¨­å®šã¯GSAPã‚’ä½¿ã£ã¦ã¾ã™ï¼
ã¾ãšã¯ã€ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã®`onMouseMove()`ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼

### onMouseMove()

```js title="onMouseMove()"
onMouseMove(e) {
  gsap.to(this.mouse, {
    x: e.clientX,
    y: e.clientY,
    top: 0,
    left: 0,
    duration: 0.5,
    onStart: () => {
      this.updateMask(e.clientX, e.clientY);
    }
  })
}
```

ã“ã‚Œã¯ãŸã ã®ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ãªã®ã§èª¬æ˜ãŒã„ã‚‰ãªã„ã‹ã¨æ€ã„ã¾ã™ãŒã€`onStart`ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«èƒŒæ™¯ã‚’clip-pathã§åˆ‡ã‚ŠæŠœã`updateMask()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

### updateMask()

```js title="updateMask()"
updateMask(x, y) {
  gsap.to(this.overlay, {
    clipPath: this.getMaskValue(x, y),
    duration: 0.2,
  });
}
```

`getMaskValue()`ã¯ã€ãƒã‚¦ã‚¹ä½ç½®(x,y)ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã“ã¨ã§clip-pathã§åˆ‡ã‚ŠæŠœã‘ã‚‹ãƒã‚¦ã‚¹ä½ç½®ã«å¿œã˜ãŸæ­£æ–¹å½¢ã®åˆ‡ã‚ŠæŠœãã®å€¤ã‚’è¿”ã—ã¦ãã‚Œã¾ã™ã€‚
ã“ã†ã™ã‚‹ã“ã¨ã§ã€blurãŒã‹ã‹ã£ãŸèƒŒæ™¯ã‚’clip-pathã§åˆ‡ã‚ŠæŠœãã“ã¨ãŒã§ãã¾ã™ã€‚

æœ€å¾Œã«ãƒã‚¦ã‚¹ä½ç½®ã«å¿œã˜ãŸæ­£æ–¹å½¢ã®åˆ‡ã‚ŠæŠœãã®å€¤ã‚’è¿”ã™`getMaskValue()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼

### getMaskValue()

ä»Šå›ã§ä¸€ç•ªåˆ†ã‹ã‚Šã¥ã‚‰ã„ç®‡æ‰€ã‹ã¨æ€ã„ã¾ã™ãŒã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```js title="getMaskValue()
getMaskValue(x, y) {
  const { width, height } = this.mouse.getBoundingClientRect();
  const offset = 40;

  const boxWidth = width - offset; // åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®å¹…
  const boxHeight = height - offset; // åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®é«˜ã•

  const viewportWidth = window.innerWidth;
  const viewportHeight = window.innerHeight;

  const left = Math.max(x - boxWidth / 2, 0);
  const top = Math.max(y - boxHeight / 2, 0);
  const right = Math.min(x + boxWidth / 2, viewportWidth);
  const bottom = Math.min(y + boxHeight / 2, viewportHeight);

  const clipPathValue = `polygon(
    0% 0%,
    0% 100%,
    ${left}px 100%,
    ${left}px ${top}px,
    ${right}px ${top}px,
    ${right}px ${bottom}px,
    ${left}px ${bottom}px,
    ${left}px 100%,
    100% 100%,
    100% 0%
  )`;
  return clipPathValue;
}
```

clip-pathã§æ­£æ–¹å½¢ã§åˆ‡ã‚ŠæŠœãç®‡æ‰€ãŒè¤‡é›‘ã§ã™ã­ã€œã€‚
ã“ã¡ã‚‰ã®11å€‹ã®å€¤ã¯â†“ã®ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ã€ŒFrameã€ã‚’å‚è€ƒã«ã—ã¾ã—ãŸï¼

https://bennettfeely.com/clippy/

!['clippy'](../../../assets/images/post/mouse-blur-clip-path-01.jpg 'â†‘ã®Frameã®å€¤ã‚’å‚è€ƒ')

ã“ã“ã§ã¯leftã®å€¤ã®ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```js
const { width, height } = this.mouse.getBoundingClientRect();
const offset = 40;

const boxWidth = width - offset; // åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®å¹…

const left = Math.max(x - boxWidth / 2, 0);
```

this.mouseã¯ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼(.cursor)ã®ã“ã¨ã§ã€`getBoundingClientRect()`ã§ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã®æ¨ªå¹…ã¨ç¸¦å¹…ã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã“ã§ã€ãƒã‚¦ã‚¹ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼ã«ã¯é£¾ã‚Š(.cursor-deco)ãŒã‚ã‚‹ã®ã§offsetåˆ†ã‚’å¼•ã„ã¦æ­£æ–¹å½¢ã®å†…å´ã§åˆ‡ã‚ŠæŠœãã“ã¨ã§è¢«ã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ã¾ã™ã€‚

æœ€å¾Œã«ãƒã‚¦ã‚¹ä½ç½®ã®å·¦å´ã®åº§æ¨™ã‚’å–å¾—ã—ãŸã„ã®ã§ã€ãƒã‚¦ã‚¹ä½ç½®ã‹ã‚‰åˆ‡ã‚ŠæŠœãå››è§’å½¢ã®å¹…(boxWidth)ã®åŠåˆ†ã‚’å¼•ãã“ã¨ã§å·¦å´ã®åº§æ¨™ã‚’å–å¾—ã§ãã¾ã™ã€‚
å››è§’å½¢ãŒç”»é¢å¤–ã«ã§ã‚‹ã¨ãƒã‚¤ãƒŠã‚¹ã®å€¤ã«ãªã‚‹ã®ã§ã€`Math.max()`ã‚’ä½¿ã£ã¦æœ€å°ã‚’0ã«ã—ã¦ã¾ã™ã€‚

top,bottom,rightã«é–¢ã—ã¦ã‚‚åŒæ§˜ã®è€ƒãˆæ–¹ã«ãªã‚Šã¾ã™ï¼

### init()

æœ€å¾Œã«init()ã§clip-pathã‚’ã‚»ãƒƒãƒˆã—ã¦ã„ã‚‹ç†ç”±ã§ã™ãŒã€åˆå›è¡¨ç¤ºæ™‚ã«ç”»é¢ä¸­å¿ƒã‚’åˆ‡ã‚ŠæŠœãã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã‚»ãƒƒãƒˆã—ã¦ã„ã¾ã™ã€‚ãªã®ã§å¿˜ã‚Œãšã«è¨˜è¼‰ã—ã¦ãŠãã¾ã—ã‚‡ã†ï¼

```js title="åˆå›è¡¨ç¤ºæ™‚ã«çœŸã‚“ä¸­ã«ã™ã‚‹è¨­å®š" {4-5}
init() {
  this.overlay = document.querySelector('.overlay');

  const setClipPathValue = this.getMaskValue(window.innerWidth/2, window.innerHeight/2)
  gsap.set(this.overlay, { clipPath: setClipPathValue });

  window.addEventListener('mousemove', (e) => this.onMouseMove(e));
}

```

## ã¾ã¨ã‚

ãƒã‚¦ã‚¹ç§»å‹•ã§èƒŒæ™¯ã‚’åˆ‡ã‚ŠæŠœãclip-pathã¨blurã‚’ä½¿ã£ãŸå‹•çš„ãƒ‡ã‚¶ã‚¤ãƒ³ã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã—ãŸã€‚

æœ€è¿‘è¦‹ãŸã‚µã‚¤ãƒˆã§çœŸä¼¼ã—ã¦ã¿ãŸã„å®Ÿè£…ã ã£ãŸã®ã§ã€ä»Šå›å–ã‚Šä¸Šã’ã¦ã¿ã¾ã—ãŸã€‚
ä»Šå¾Œã‚‚çœŸä¼¼ã—ãŸã„ã‚µã‚¤ãƒˆã‚’è¦‹ã¤ã‘ãŸã‚‰å®Ÿè£…ã—è§£èª¬ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼

ã“ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚