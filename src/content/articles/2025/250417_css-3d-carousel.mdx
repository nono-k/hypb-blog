---
title: CSS transform ã¨ perspective ã‚’ä½¿ã£ãŸ3Dã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®ä½œã‚Šæ–¹
slug: css-3d-carousel
pubDate: '2025-04-17'
image: ../../../assets/images/css-3d-carousel.jpg
ogp: 'images/ogp/css-3d-carousel.jpg'
category: Coding
tags:
  - CSS
  - 3D
description: CSSã®transformã¨perspectiveã‚’ä½¿ã£ãŸ3Dã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚
relatedPosts:
  - recommended-book-for-frontend-devs
---
import CodePenEmbed from '../../../components/markdown/CodePenEmbed.astro';
import PostAdUnit from '../../../components/markdown/PostAdUnit.astro';

## ã¯ã˜ã‚ã«

ä»Šå›ã¯CSSã®`perspective`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨`preserve-3d`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ã¦3Dã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’ä½œã£ã¦ã¿ãŸã®ã§ã€ãã®æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚ã‚«ãƒ¼ãƒ«ã‚»ãƒ«ã®åˆ¶å¾¡ãªã©ã«ã¯JavaScriptã‚’ä½¿ã£ã¦ã„ã¦ã€3Dã®æ„Ÿã˜ã¯CSSã§è¡¨ç¾ã—ã¦ã¾ã™ã€‚

ğŸ‘‡ã¯å®Œæˆå½¢ã®CodePenãƒ‡ãƒ¢ã§ã™ï¼(ç”»é¢å¹…ã«ã‚ˆã£ã¦ã¯ä¸Šæ‰‹ãè¡¨ç¤ºã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§CodePenä¸Šã§ç”»é¢ã‚’åºƒã’ã¦ã¿ã¦ãã ã•ã„)

<CodePenEmbed penId="myybJKY" title="CSS 3D Carousel" />

â†“ä»Šå›ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã™ã€‚

https://github.com/nono-k/css-3d-carousel

## HTML

HTMLã¯ä¸‹è¨˜ã®é€šã‚Šã«ãªã‚Šã¾ã™ã€‚ä»Šå›ã¯è¦ç´ ã‚’8å€‹ã¨ã—`scene`ã¨`carousel`ã‚¯ãƒ©ã‚¹ã§ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚ã€ŒPrevã€ã€ŒNextã€ãƒœã‚¿ãƒ³ã¯`carousel__prev`ã¨`carousel__next`ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ã¾ã™ã€‚

```html title="index.html"
<div class="scene">
  <div class="carousel">
    <div class="carousel__item">1</div>
    <div class="carousel__item">2</div>
    <div class="carousel__item">3</div>
    <div class="carousel__item">4</div>
    <div class="carousel__item">5</div>
    <div class="carousel__item">6</div>
    <div class="carousel__item">7</div>
    <div class="carousel__item">8</div>
  </div>
</div>
<div class="carousel__prev">Prev</div>
<div class="carousel__next">Next</div>
```

## CSS

æ¬¡ã«åŸºæœ¬çš„ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’è¨­å®šã—ã¾ã™ã€‚å„ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®é–“éš”ã‚’20pxã«ã™ã‚‹ãŸã‚ã€widthã¨heightã‚’`calc(100% - 20px)`ã«ã—ã¦ã¾ã™ã€‚å®Ÿéš›ã®sceneã®å¹…ã¯260pxã¨ã—ã¦ã¾ã™ã€‚

```scss title="styles.scss"
.scene {
  width: 260px;
  aspect-ratio: 16 / 9;
  position: relative;
  perspective: var(--perspective);
}

.carousel {
  width: 100%;
  height: 100%;
  position: absolute;
  transform-style: preserve-3d;
  transition: transform 1s;
  &__item {
    position: absolute;
    width: calc(100% - 20px);
    height: calc(100% - 20px);
    top: 50%;
    left: 50%;

    transform: translate(-50%, -50%)
    ã€€ã€€ã€€ã€€ã€€ã€€ã€€rotateY(var(--rotateY))
    ã€€ã€€ã€€ã€€ã€€ã€€ã€€translateZ(var(--tz));

    background-color: hsl(var(--hue) 80% 45% / 90%);
    font-size: 3rem;
    color: #fff;
    display: grid;
    place-items: center;
  }
}
```

3æ¬¡å…ƒã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã€è¦ªã®`scene`ã‚¯ãƒ©ã‚¹ã«`perspective`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®å€¤ã¯å¾Œã§JavaScriptå´ã§è¨ˆç®—ã—ã¦è¨­å®šã—ã¾ã™ã€‚åŒæ§˜ã«`rotateY`ã¨`translateZ`ã‚‚JavaScriptå´ã§è¨ˆç®—ã—ã¦è¨­å®šã—ã¾ã™ã€‚

ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã®è‰²(`--hue`)ã‚‚ã€JavaScriptå´ã§è¨­å®šã—ã¾ã™ã€‚ãã‚Œã§ã¯ã€JavaScriptå´ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

<PostAdUnit />

## JavaScript

ä»¥ä¸‹ã€JavaScriptã®å…¨ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚

```js title="script.js"
class Carousel3D {
  constructor() {
    this.carousel = document.querySelector('.carousel');
    this.carouselItems = this.carousel.querySelectorAll('.carousel__item');
    this.rotation = 0;
    this.angle = 360 / this.carouselItems.length;

    this.init();
  }
  init() {
    this.setUp();
    this.clickHandler();
  }
  setUp() {
    const scene = document.querySelector('.scene');
    const sceneSize = scene.clientWidth;
    const tz = sceneSize / 2 / Math.tan(Math.PI * this.angle / 180 / 2);

    scene.style.perspective = `${tz * 2}px`;

    this.carouselItems.forEach((item, i) => {
      item.style.setProperty('--hue', `${i * this.angle}deg`);
      item.style.setProperty('--rotateY', `${i * this.angle}deg`);
      item.style.setProperty('--tz', `${tz}px`);
    });
  }
  clickHandler() {
    const prevBtn = document.querySelector('.carousel__prev');
    const nextBtn = document.querySelector('.carousel__next');

    prevBtn.addEventListener('click', () => {
      this.rotation += this.angle;
      this.carousel.style.setProperty('--rotateY', `${this.rotation}deg`);
    });

    nextBtn.addEventListener('click', () => {
      this.rotation -= this.angle;
      this.carousel.style.setProperty('--rotateY', `${this.rotation}deg`);
    });
  }
}

new Carousel3D();
```

ã“ã¡ã‚‰ã®ã‚³ãƒ¼ãƒ‰ã‚’é †ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ä¸¦ã¹ã‚‹è§’åº¦ã‚’è¨ˆç®—ã™ã‚‹

ä»Šå›ã¯ç«‹ä½“ã«è¦‹ãˆã‚‹ã‚ˆã†ã«ä¸¦ã¹ã¦ã„ãã®ã§ã€ä¸¦ã¹ã‚‹è§’åº¦ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
ä¸¦ã¹ã‚‹è§’åº¦ã®è¨ˆç®—å¼ã¨ã—ã¦ã¯360åº¦ã‹ã‚‰è¦ç´ ã®æ•°ã‚’å‰²ã‚‹ã“ã¨ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```js
this.angle = 360 / this.carouselItems.length;
```

ä»Šå›ã¯è¦ç´ ã®æ•°ãŒ8ã¤ãªã®ã§ã€45åº¦ãšã¤ä¸¦ã¹ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

### ç«‹ä½“ã«è¦‹ãˆã‚‹ã‚ˆã†ã«ä¸¦ã¹ã‚‹

ã“ã“ã§ã€ç«‹ä½“ã«è¦‹ãˆã‚‹ä¸¦ã¹æ–¹ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ä¸‹è¨˜ã®å›³ã¯ã‚«ãƒ¼ãƒ«ã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰è¦‹ãŸå›³ã«ãªã‚Šã¾ã™ã€‚

!['ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰è¦‹ãŸå›³'](../../../assets/images/post/css-3d-carousel-01.jpg 'ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰è¦‹ãŸå›³')

ã“ã“ã§æ—¢çŸ¥ã®å€¤ã¨ã—ã¦ã¯ã€ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®å¹…(260px)ã¨è§’åº¦(45åº¦)ã«ãªã‚Šã¾ã™ã€‚ç«‹ä½“ã«è¦‹ãˆã‚‹ã‚ˆã†ã«ä¸¦ã¹ã‚‹ãŸã‚ã«æ¬²ã—ã„å€¤ã¨ã—ã¦ã¯å›³ã®rã®å€¤ã«ãªã‚Šã¾ã™ã€‚rã®å€¤ã¯å›³ã®å³ã®ç›´è§’ä¸‰è§’å½¢ã‹ã‚‰æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

$$
r = \frac{130}{\tan(22.5^\circ)}
$$

è«¸ã€…ã®è¨ˆç®—ã‚’ã—ã¦ã‚‹ã®ãŒã€`setUp`ãƒ¡ã‚½ãƒƒãƒ‰ã«ãªã‚Šã¾ã™ã€‚

```js
setUp() {
  const scene = document.querySelector('.scene');
  const sceneSize = scene.clientWidth;
  const tz = sceneSize / 2 / Math.tan(Math.PI * this.angle / 180 / 2);

  scene.style.perspective = `${tz * 2}px`;

  this.carouselItems.forEach((item, i) => {
    item.style.setProperty('--hue', `${i * this.angle}deg`);
    item.style.setProperty('--rotateY', `${i * this.angle}deg`);
    item.style.setProperty('--tz', `${tz}px`);
  });
}
```

ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰è¦‹ãŸå›³ã‚’è¦‹ãŸé€šã‚Šã€è¦ªã®`scene`ã‚¯ãƒ©ã‚¹ã®`perspective`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã¯ã€rã®å€¤ã®2å€ã«ãªã‚‹ã®ã§2å€ã—ã¦è¨­å®šã—ã¦ã¾ã™ã€‚å¾Œã¯ã€å„ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®`--hue`ã€`--rotateY`ã€`--tz`ã®å€¤ã‚’ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

cssã‚’å†æ²ã™ã‚‹ã¨ã€ã“ã®ã‚ˆã†ã«ãªã£ã¦ã¾ã™ã€‚

```scss
.carousel {

  &__item {
    transform: translate(-50%, -50%)
    ã€€ã€€ã€€ã€€ã€€ã€€ã€€rotateY(var(--rotateY))
    ã€€ã€€ã€€ã€€ã€€ã€€ã€€translateZ(var(--tz));

    background-color: hsl(var(--hue) 80% 45% / 90%);
  }
}
```

ã“ã‚Œã§ç«‹ä½“ã«è¦‹ãˆã‚‹ã‚ˆã†ã«ä¸¦ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®å¤§ãã•ã«ã¤ã„ã¦ã¯ã€`scene`ã‚¯ãƒ©ã‚¹ã®`width`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã€`--perspective`ã®å€¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§å¤‰æ›´ã§ãã¾ã™ã€‚æœ€å¾Œã«ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’å›è»¢ã•ã›ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’å›è»¢ã•ã›ã‚‹

ä¸Šã‹ã‚‰è¦‹ãŸå›³ã‚’è¦‹ãŸé€šã‚Šã€ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’å›è»¢ã•ã›ã‚‹ãŸã‚ã«ã¯ã€Yè»¸æ–¹å‘ã«å›è»¢ã•ã›ã‚Œã°è‰¯ã„ã§ã™ã€‚ãã®ã‚ˆã†ã«ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã«ã€`--rotateY`ã®å€¤ã‚’å¤‰æ›´ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```js
clickHandler() {
  const prevBtn = document.querySelector('.carousel__prev');
  const nextBtn = document.querySelector('.carousel__next');

  prevBtn.addEventListener('click', () => {
    this.rotation += this.angle;
    this.carousel.style.setProperty('--rotateY', `${this.rotation}deg`);
  });

  nextBtn.addEventListener('click', () => {
    this.rotation -= this.angle;
    this.carousel.style.setProperty('--rotateY', `${this.rotation}deg`);
  });
}
```

ã“ã‚Œã§ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’å›è»¢ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

---

## ã¾ã¨ã‚

CSSã®`perspective`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨`preserve-3d`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã£ãŸ3Dã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã—ãŸã€‚ã»ã¼CSSã®ã¿ã§ãƒªãƒƒãƒãªã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸğŸ 

ä¸‰è§’é–¢æ•°ã®ä½¿ã„æ‰€ãªã©å‚è€ƒã«ãªã£ãŸãªã‚‰ã°å¹¸ã„ã§ã™ã€‚

## å‚è€ƒ

- [Intro to CSS 3D transforms - Carousel](https://3dtransforms.desandro.com/carousel)